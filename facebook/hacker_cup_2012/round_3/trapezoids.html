<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Puzzles</title>

    
    <link rel="stylesheet" href="../../../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/theme_extras.js"></script>
    <link rel="top" title="Puzzles 1.0 documentation" href="../../../index.html" />
    <link rel="up" title="Round 3" href="../round_3.html" />
    <link rel="next" title="Unfriending" href="unfriending.html" />
    <link rel="prev" title="Divisor Function Optimization" href="divisor_function_optimization.html" /> 
  </head>
  <body>
      <div class="header">
    <h1 class="heading">
        <a href="../../../index.html">
          <span>Puzzles</span>
        </a>
    </h1>

      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="divisor_function_optimization.html">Divisor Function Optimization</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="unfriending.html">Unfriending</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="trapezoids">
<h1>Trapezoids<a class="headerlink" href="#trapezoids" title="Permalink to this headline">¶</a></h1>
<p>Consider two horizontal lines and a set of <strong>N</strong> trapezoids. A trapezoid
<strong>T[i]</strong> between these lines has two vertices situated on the upper line and
the other two vertices on the lower line. We will denote by <strong>a[i]</strong>, <strong>b[i]</strong>,
<strong>c[i]</strong> and <strong>d[i]</strong> the upper left, upper right, lower left and respectively
lower right vertices of the trapezoid <strong>T[i]</strong>. Assume that no two trapezoids
share a common vertex (meaning that all <strong>a[i]</strong> and <strong>b[i]</strong> coordinates on
the upper line are different, and the same holds for the bottom line and
coordinates <strong>c[i]</strong> and <strong>d[i]</strong>). A trapezoid set is called <strong>disconnected</strong>
if one can separate the trapezoids in two or more groups such that no two
trapezoids from different groups intersect. Determine the smallest number of
trapezoids to remove, such that the remaining trapezoids form a disconnected
set. If the solution does not exist, output <strong>-1</strong>.</p>
<div class="section" id="input">
<h2>Input<a class="headerlink" href="#input" title="Permalink to this headline">¶</a></h2>
<p>The first line of the input file contains an integer <strong>T</strong>, and this is
followed by <strong>T</strong> test cases. Each test case is given in the compressed format.</p>
<p>The first line of each test case contains the number of trapezoids <strong>N</strong>, an
integer <strong>K</strong>, and integer parameters <strong>X, A, B, M, p, q</strong>. In the next <strong>K</strong>
lines are given integer numbers <strong>aa[i], bb[i], cc[i], dd[i]</strong>. The following
code is used for generating the next random number using linear congruential
generator with the starting value <strong>X</strong> and parameters <strong>A, B</strong> and modulo
<strong>M</strong>:</p>
<div class="highlight-text"><div class="highlight"><pre>long long prior = X;
long long next() {
  prior = (A * prior + B) % M;
  return prior;
}
</pre></div>
</div>
<p>The following code is used for extending the auxiliary sequences <strong>aa, bb, cc</strong>
and <strong>dd</strong>:</p>
<div class="highlight-text"><div class="highlight"><pre>for (int i = K; i &lt; N; i++) {
    aa [i] = aa [i - K] + next() % (2 * p) - p;
    bb [i] = aa [i] + 1 + next() % (2 * (bb [i % K] - aa [i % K]));
    cc [i] = cc [i - K] + next() % (2 * q) - q;
    dd [i] = cc [i] + 1 + next() % (2 * (dd [i % K] - cc [i % K]));
}
</pre></div>
</div>
<p>The final coordinates of the trapezoids are given by:</p>
<div class="highlight-text"><div class="highlight"><pre>for (int i = 0; i &lt; N; i++) {
    a [i] = aa [i] * 1000000 + i;
    b [i] = bb [i] * 1000000 + i;
    c [i] = cc [i] * 1000000 + i;
    d [i] = dd [i] * 1000000 + i;
}
</pre></div>
</div>
<p>Note that above code generates trapezoids that satisfy all conditions of the
problem, and &#8216;%&#8217; denotes the remainder of division.</p>
</div>
<div class="section" id="output">
<h2>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<p>For each of the test cases numbered in order from <strong>1</strong> to <strong>T</strong>, output &#8220;Case
#i: &#8221; followed by a single integer, the minimum number of trapezoids that need
to be removed such that the remaining trapezoids form a disconnected set.</p>
</div>
<div class="section" id="constraints">
<h2>Constraints<a class="headerlink" href="#constraints" title="Permalink to this headline">¶</a></h2>
<p>1 ≤ <strong>T</strong> ≤ 20</p>
<p>1 ≤ <strong>N</strong> ≤ 300 000</p>
<p>1 ≤ <strong>K</strong> ≤ <strong>N</strong></p>
<p>0 ≤ <strong>X, A, B</strong> ≤ 2 000 000 000</p>
<p>-2 000 000 000 ≤ <strong>aa[i], bb[i], cc[i], dd[i]</strong> ≤ 2 000 000 000</p>
<p>1 ≤ <strong>p, q, M</strong> ≤ 2 000 000 000</p>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>In the first example, one can remove trapezoids 5 and 6 leaving two disconnected
sets with trapezoids (1, 2, 3, 4) and (7, 8).</p>
<p>In the second example, the coordinates of ten trapezoids are</p>
<div class="highlight-text"><div class="highlight"><pre>1000000 4000000 3000000 5000000
7000001 8000001 2000001 6000001
2000002 7000002 2000002 5000002
5000003 7000003 2000003 6000003
4 6000004 2000004 3000004
4000005 5000005 3000005 8000005
-999994 6 6 2000006
4000007 6000007 1000007 7000007
-999992 8 -999992 2000008
5000009 6000009 9 7000009
</pre></div>
</div>
</div>
<div class="section" id="example-input">
<h2>Example input<a class="headerlink" href="#example-input" title="Permalink to this headline">¶</a></h2>
<div class="highlight-text"><div class="highlight"><pre>5

8 8 1 1 1 1 1 1
1 3 1 3
2 5 6 10
4 8 5 8
6 9 2 4
7 11 11 13
10 13 7 9
12 16 14 15
14 15 12 16

10 2 2 1 1 7 2 2
1 4 3 5
7 8 2 6

100000 2 1 1 1 2 1 1
-2 -1 -1000001 -1000000
-1000001 -1000000 -2 -1

200 3 5 1 2 1117 11 13
1 10 1 10
2 11 2 11
3 12 3 12

10000 1 0 0 1 2 1 1
1 10000 1 100000
</pre></div>
</div>
</div>
<div class="section" id="example-output">
<h2>Example output<a class="headerlink" href="#example-output" title="Permalink to this headline">¶</a></h2>
<div class="highlight-text"><div class="highlight"><pre>Case #1: 2
Case #2: 6
Case #3: 50002
Case #4: 61
Case #5: -1
</pre></div>
</div>
<p><a class="reference external" href="https://www.facebook.com/hackercup/problems.php?pid=182208915220500&amp;round=222291111185610">View online</a>.</p>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="divisor_function_optimization.html">Divisor Function Optimization</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="unfriending.html">Unfriending</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>