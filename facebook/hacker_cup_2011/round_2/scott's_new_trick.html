<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Puzzles</title>

    
    <link rel="stylesheet" href="../../../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/theme_extras.js"></script>
    <link rel="top" title="Puzzles 1.0 documentation" href="../../../index.html" />
    <link rel="up" title="Round 2" href="../round_2.html" />
    <link rel="next" title="Studious Student II" href="studious_student_ii.html" />
    <link rel="prev" title="Bonus Assignments" href="bonus_assignments.html" /> 
  </head>
  <body>
      <div class="header">
    <h1 class="heading">
        <a href="../../../index.html">
          <span>Puzzles</span>
        </a>
    </h1>

      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="bonus_assignments.html">Bonus Assignments</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="studious_student_ii.html">Studious Student II</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="scott-s-new-trick">
<h1>Scott&#8217;s New Trick<a class="headerlink" href="#scott-s-new-trick" title="Permalink to this headline">¶</a></h1>
<p>Little Scott recently learned how to perform arithmetic operations modulo some
prime number <strong>P</strong>. As a training set he picked two sequences <strong>a</strong> of length
<strong>N</strong> and <strong>b</strong> of length <strong>M</strong>, generated in the following way:</p>
<p>a<sub>1</sub>=A1
a<sub>2</sub>=A2
a<sub>i</sub>=(a<sub>i-2</sub> * A3 + a<sub>i-1</sub> * A4 + A5) mod P, for i=3...
<strong>N</strong>
b<sub>1</sub>=B1
b<sub>2</sub>=B2
b<sub>j</sub>=(b<sub>j-2</sub> * B3 + b<sub>j-1</sub> * B4 + B5) mod P, for j=3...
<strong>M</strong></p>
<p>Now he wants to find the number of pairs (i, j), where 1 ≤ i ≤ <strong>N</strong> and 1 ≤ j
≤ <strong>M</strong>, such that (a<sub>i</sub> * b<sub>j</sub>) mod <strong>P</strong> &lt; <strong>L</strong>, for given
number <strong>L</strong>. He asked you to do the same to help him check his answers.</p>
<div class="section" id="input">
<h2>Input<a class="headerlink" href="#input" title="Permalink to this headline">¶</a></h2>
<p>The first line of input file consists of a single number <strong>T</strong>, the number of
test cases. Each test consists of three lines. The first line of a test case
contains two integers: prime number <strong>P</strong> and positive integer <strong>L</strong>. The
second line consists of six non-negative integers <strong>N</strong>, <strong>A1</strong>, <strong>A2</strong>,
<strong>A3</strong>, <strong>A4</strong>, <strong>A5</strong>. Likewise, the third line contains six non-negative
integers <strong>M</strong>, <strong>B1</strong>, <strong>B2</strong>, <strong>B3</strong>, <strong>B4</strong>, <strong>B5</strong>.</p>
</div>
<div class="section" id="output">
<h2>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<p>Output <strong>T</strong> lines, with the answer to each test case on a single line.</p>
</div>
<div class="section" id="constraints">
<h2>Constraints<a class="headerlink" href="#constraints" title="Permalink to this headline">¶</a></h2>
<p><strong>T</strong> = 20</p>
<p>2 ≤ <strong>P</strong> &lt; 250,000</p>
<p><strong>P</strong> is prime</p>
<p>1 ≤ <strong>L</strong> ≤ <strong>P</strong></p>
<p>2 ≤ <strong>N</strong>, <strong>M</strong> ≤ 10,000,000</p>
<p>0 ≤ <strong>A1</strong>, <strong>A2</strong>, <strong>A3</strong>, <strong>A4</strong>, <strong>A5</strong>, <strong>B1</strong>, <strong>B2</strong>, <strong>B3</strong>,
<strong>B4</strong>, <strong>B5</strong> &lt; P</p>
</div>
<div class="section" id="example-input">
<h2>Example input<a class="headerlink" href="#example-input" title="Permalink to this headline">¶</a></h2>
<div class="highlight-text"><div class="highlight"><pre>5
3 1
4 0 2 2 2 2
2 1 2 1 0 0
3 1
5 2 0 0 1 1
5 1 1 2 0 0
3 3
5 0 0 1 2 2
3 2 1 1 1 1
5 1
5 2 0 4 0 4
3 2 1 2 4 4
5 4
2 2 1 3 1 4
5 1 0 2 3 3
</pre></div>
</div>
</div>
<div class="section" id="example-output">
<h2>Example output<a class="headerlink" href="#example-output" title="Permalink to this headline">¶</a></h2>
<div class="highlight-text"><div class="highlight"><pre>Case #1: 6
Case #2: 10
Case #3: 15
Case #4: 3
Case #5: 9
</pre></div>
</div>
<p><a class="reference external" href="https://www.facebook.com/hackercup/problems.php?pid=134500253280699&amp;round=178767375498716">View online</a>.</p>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="bonus_assignments.html">Bonus Assignments</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="studious_student_ii.html">Studious Student II</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>